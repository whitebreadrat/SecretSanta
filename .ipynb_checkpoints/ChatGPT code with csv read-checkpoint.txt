import smtplib
import random
import csv

# Enter your email and password for the sender's email account
sender_email = "your_email@example.com"
password = "your_password"

# Read participant data from the CSV file
participants = []
with open("secret_santa.csv", "r") as file:
    reader = csv.DictReader(file)
    for row in reader:
        participants.append(row)

# Randomly shuffle the participants list
random.shuffle(participants)

# Generate Secret Santa pairs
pairs = zip(participants, participants[1:] + [participants[0]])

# Send email to each participant with their assigned pick
for giver, receiver in pairs:
    giver_name = giver["name"]
    giver_email = giver["email"]
    receiver_name = receiver["name"]

    message = f"Hello {giver_name}!\n\nYou are assigned to be the Secret Santa for {receiver_name} this year."

    # Connect to the email server
    server = smtplib.SMTP("smtp.gmail.com", 587)
    server.starttls()
    server.login(sender_email, password)

    # Send the email
    server.sendmail(sender_email, giver_email, message)
    server.quit()

    print(f"Email sent to {giver_name} ({giver_email}) with their assigned pick.")
